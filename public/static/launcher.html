<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>케이밴 (K-VAN) - PV5 시공관리 시스템</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap');
        
        * {
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        body {
            background: linear-gradient(to bottom, #0a1628 0%, #0f172a 30%, #1e293b 100%);
            min-height: 100vh;
            padding: 40px 20px;
            position: relative;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(59, 130, 246, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(139, 92, 246, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }
        
        .launcher-container {
            max-width: 1600px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }
        
        .header-logo {
            display: inline-flex;
            align-items: center;
            gap: 16px;
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            padding: 20px 40px;
            border-radius: 24px;
            box-shadow: 
                0 20px 60px rgba(59, 130, 246, 0.3),
                0 0 0 1px rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
        }
        
        /* PV5 Showcase Section */
        .showcase-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
            margin-bottom: 80px;
        }
        
        .showcase-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 32px;
            overflow: hidden;
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
        }
        
        .showcase-card:hover {
            transform: translateY(-8px);
            border-color: rgba(255, 255, 255, 0.15);
            box-shadow: 
                0 30px 80px rgba(0, 0, 0, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
        }
        
        .showcase-card img {
            width: 100%;
            height: auto;
            display: block;
            flex-shrink: 0;
        }
        
        .showcase-info {
            padding: 48px 40px;
            background: linear-gradient(to bottom, rgba(0, 0, 0, 0.2) 0%, rgba(0, 0, 0, 0.6) 100%);
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        /* Branch Grid */
        .branch-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 28px;
            margin-bottom: 80px;
        }
        
        .branch-card {
            background: rgba(255, 255, 255, 0.04);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 28px;
            padding: 40px 28px;
            text-align: center;
            cursor: pointer;
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            overflow: hidden;
        }
        
        .branch-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.08) 0%, transparent 100%);
            opacity: 0;
            transition: opacity 0.5s;
        }
        
        .branch-card::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 0;
            height: 0;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            transition: all 0.6s;
        }
        
        .branch-card:hover {
            transform: translateY(-12px) scale(1.03);
            border-color: rgba(255, 255, 255, 0.2);
            box-shadow: 
                0 25px 70px rgba(0, 0, 0, 0.4),
                0 0 60px rgba(var(--glow-color), 0.3);
        }
        
        .branch-card:hover::before {
            opacity: 1;
        }
        
        .branch-card:hover::after {
            width: 300px;
            height: 300px;
        }
        
        /* 3D Icon Container */
        .branch-icon {
            width: 72px;
            height: 72px;
            margin: 0 auto 20px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            position: relative;
            transform-style: preserve-3d;
            transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        
        .branch-icon::before {
            content: '';
            position: absolute;
            inset: -2px;
            border-radius: 26px;
            padding: 2px;
            background: linear-gradient(135deg, rgba(255,255,255,0.2), rgba(255,255,255,0.05));
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            opacity: 0;
            transition: opacity 0.5s;
        }
        
        .branch-card:hover .branch-icon {
            transform: translateZ(20px) rotateY(10deg) scale(1.15);
        }
        
        .branch-card:hover .branch-icon::before {
            opacity: 1;
        }
        
        .branch-icon i {
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
            transition: all 0.5s;
        }
        
        .branch-card:hover .branch-icon i {
            filter: drop-shadow(0 8px 16px rgba(0, 0, 0, 0.5));
            transform: scale(1.1);
        }
        
        .branch-name {
            font-size: 1.375rem;
            font-weight: 800;
            color: white;
            margin-bottom: 6px;
            letter-spacing: -0.02em;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .branch-subtitle {
            font-size: 0.875rem;
            color: rgba(255, 255, 255, 0.5);
            font-weight: 600;
            letter-spacing: 0.05em;
            text-transform: uppercase;
        }
        
        /* 각 지사별 고유 색상 & Glow */
        .branch-card[data-branch="hq"] {
            --glow-color: 139, 92, 246;
        }
        .branch-card[data-branch="hq"] .branch-icon {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            box-shadow: 
                0 10px 40px rgba(139, 92, 246, 0.4),
                inset 0 -2px 10px rgba(0, 0, 0, 0.2),
                inset 0 2px 10px rgba(255, 255, 255, 0.2);
        }
        
        .branch-card[data-branch="seoul"] {
            --glow-color: 59, 130, 246;
        }
        .branch-card[data-branch="seoul"] .branch-icon {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            box-shadow: 
                0 10px 40px rgba(59, 130, 246, 0.4),
                inset 0 -2px 10px rgba(0, 0, 0, 0.2),
                inset 0 2px 10px rgba(255, 255, 255, 0.2);
        }
        
        .branch-card[data-branch="gyeongbuk"] {
            --glow-color: 16, 185, 129;
        }
        .branch-card[data-branch="gyeongbuk"] .branch-icon {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            box-shadow: 
                0 10px 40px rgba(16, 185, 129, 0.4),
                inset 0 -2px 10px rgba(0, 0, 0, 0.2),
                inset 0 2px 10px rgba(255, 255, 255, 0.2);
        }
        
        .branch-card[data-branch="honam"] {
            --glow-color: 245, 158, 11;
        }
        .branch-card[data-branch="honam"] .branch-icon {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            box-shadow: 
                0 10px 40px rgba(245, 158, 11, 0.4),
                inset 0 -2px 10px rgba(0, 0, 0, 0.2),
                inset 0 2px 10px rgba(255, 255, 255, 0.2);
        }
        
        .branch-card[data-branch="gyeongnam"] {
            --glow-color: 239, 68, 68;
        }
        .branch-card[data-branch="gyeongnam"] .branch-icon {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            box-shadow: 
                0 10px 40px rgba(239, 68, 68, 0.4),
                inset 0 -2px 10px rgba(0, 0, 0, 0.2),
                inset 0 2px 10px rgba(255, 255, 255, 0.2);
        }
        
        .branch-card[data-branch="jeju"] {
            --glow-color: 20, 184, 166;
        }
        .branch-card[data-branch="jeju"] .branch-icon {
            background: linear-gradient(135deg, #14b8a6 0%, #0d9488 100%);
            box-shadow: 
                0 10px 40px rgba(20, 184, 166, 0.4),
                inset 0 -2px 10px rgba(0, 0, 0, 0.2),
                inset 0 2px 10px rgba(255, 255, 255, 0.2);
        }
        
        .branch-card[data-branch="daejeon"] {
            --glow-color: 99, 102, 241;
        }
        .branch-card[data-branch="daejeon"] .branch-icon {
            background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
            box-shadow: 
                0 10px 40px rgba(99, 102, 241, 0.4),
                inset 0 -2px 10px rgba(0, 0, 0, 0.2),
                inset 0 2px 10px rgba(255, 255, 255, 0.2);
        }
        
        .branch-card[data-branch="ocr"] {
            --glow-color: 100, 116, 139;
        }
        .branch-card[data-branch="ocr"] .branch-icon {
            background: linear-gradient(135deg, #64748b 0%, #475569 100%);
            box-shadow: 
                0 10px 40px rgba(100, 116, 139, 0.4),
                inset 0 -2px 10px rgba(0, 0, 0, 0.2),
                inset 0 2px 10px rgba(255, 255, 255, 0.2);
        }
        
        .branch-card[data-branch="admin"] {
            --glow-color: 59, 130, 246;
        }
        .branch-card[data-branch="admin"] .branch-icon {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            box-shadow: 
                0 10px 40px rgba(59, 130, 246, 0.4),
                inset 0 -2px 10px rgba(0, 0, 0, 0.2),
                inset 0 2px 10px rgba(255, 255, 255, 0.2);
        }
        
        @media (max-width: 1024px) {
            .showcase-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .branch-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 20px;
            }
            
            .branch-card {
                padding: 32px 20px;
            }
            
            .branch-icon {
                width: 64px;
                height: 64px;
                font-size: 1.75rem;
            }
            
            .branch-name {
                font-size: 1.125rem;
            }
            
            .showcase-info {
                padding: 32px 28px;
            }
        }
    </style>
</head>
<body>
    <div class="launcher-container">
        <!-- Header -->
        <div class="text-center mb-16">
            <div class="header-logo inline-block">
                <i class="fas fa-shuttle-van text-white text-4xl"></i>
                <span class="text-4xl font-black text-white tracking-tight">케이밴 K-VAN</span>
            </div>
            <p class="text-xl text-white/60 mt-6 font-semibold">
                PV5 시공관리 시스템
            </p>
        </div>

        <!-- PV5 Showcase Grid -->
        <div class="showcase-grid">
            <!-- Main PV5 Showcase -->
            <div class="showcase-card">
                <img src="/static/pv5-showcase.jpg" alt="PV5 Cargo Showcase">
                <div class="showcase-info text-center">
                    <h2 class="text-3xl font-black text-white mb-3 leading-tight">
                        비즈니스 모빌리티의<br>새로운 표준
                    </h2>
                    <p class="text-xl text-white/80 font-bold mb-2">
                        PV5 카고 솔루션
                    </p>
                    <p class="text-base text-white/60 leading-relaxed">
                        Pretendard Regular<br>
                        더 이상 단순한 운송 수단이 아닙니다.<br>
                        당신의 비즈니스를 위한 완벽한 파트너입니다.
                    </p>
                </div>
            </div>

            <!-- Interior Options -->
            <div class="showcase-card">
                <img src="/static/pv5-options.jpg" alt="PV5 Interior Options">
                <div class="showcase-info text-center">
                    <h2 class="text-3xl font-black text-white mb-6 leading-tight">
                        당신의 비즈니스<br>아이덴티티를 담은 디자인
                    </h2>
                    <div class="grid grid-cols-2 gap-6 text-left">
                        <div>
                            <p class="text-lg font-black text-blue-400 mb-2">Option A:<br>Kia Collection</p>
                            <p class="text-sm text-white/70 leading-relaxed">
                                모던하고 실용한 그레이 톤.<br>
                                기아 PV5의 순정 인테리어와<br>
                                완벽한 조화.
                            </p>
                        </div>
                        <div>
                            <p class="text-lg font-black text-red-400 mb-2">Option B:<br>Milwaukee Edition</p>
                            <p class="text-sm text-white/70 leading-relaxed">
                                강렬한 레드 컬러와<br>
                                다이내믹한 감성.<br>
                                밀워키 전동공구 시스템과의<br>
                                완벽한 컬러 매칭.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Branch Grid -->
        <div id="branchGrid" class="branch-grid">
            <!-- 동적으로 생성됩니다 -->
        </div>

        <!-- Footer -->
        <div class="text-center text-white/50 pb-12">
            <div class="flex items-center justify-center gap-4 mb-4">
                <img src="/static/kvan-logo.png" alt="K-VAN" class="h-10 bg-white/5 backdrop-blur-sm px-4 py-2 rounded-xl border border-white/10">
                <span class="text-sm font-semibold">© 2026 K-VAN. All rights reserved.</span>
            </div>
            <p class="text-xs font-semibold tracking-wider uppercase">
                비즈니스 모빌리티 혁신 파트너
            </p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios@1.6.0/dist/axios.min.js"></script>
    <script>
        // 아이콘 매핑 (지사 코드별)
        const iconMap = {
            'honam': 'fa-sun',
            'busan-gyeongnam': 'fa-anchor',
            'seoul-gyeongbuk': 'fa-city',
            'gyeonggi-gangwon': 'fa-mountain',
            'chungbuk-daejeon': 'fa-rocket',
            'default': 'fa-building'
        }

        // 페이지 로드 시 로그인 체크 및 지사 로드
        document.addEventListener('DOMContentLoaded', async () => {
            const token = localStorage.getItem('token')
            const userStr = localStorage.getItem('user')

            // 로그인 체크
            if (!token || !userStr) {
                window.location.href = '/static/login.html'
                return
            }

            const user = JSON.parse(userStr)

            // 지사 목록 로드 및 아이콘 생성
            await loadBranches(user)

            // 로그아웃 버튼 추가
            const header = document.querySelector('.header-logo')
            const logoutBtn = document.createElement('button')
            logoutBtn.innerHTML = '<i class="fas fa-sign-out-alt mr-2"></i>로그아웃'
            logoutBtn.className = 'ml-auto bg-white/10 hover:bg-white/20 text-white px-6 py-2 rounded-lg font-bold transition'
            logoutBtn.onclick = () => {
                localStorage.removeItem('token')
                localStorage.removeItem('user')
                window.location.href = '/static/login.html'
            }
            header.appendChild(logoutBtn)

            // 사용자 정보 표시
            const userInfo = document.createElement('div')
            userInfo.className = 'text-white text-sm font-semibold'
            userInfo.innerHTML = `<i class="fas fa-user-circle mr-2"></i>${user.branchName} - ${user.username}`
            header.insertBefore(userInfo, logoutBtn)
        })

        // 지사 목록 로드 및 아이콘 동적 생성
        async function loadBranches(user) {
            try {
                const response = await axios.get('/api/branches/list')
                if (!response.data.success) return

                const branches = response.data.branches
                const grid = document.getElementById('branchGrid')

                // 본사 아이콘 (본사 관리자만)
                if (user.role === 'head') {
                    grid.innerHTML += `
                        <a href="/static/hq.html" class="branch-card" data-branch="hq">
                            <div class="branch-icon">
                                <i class="fas fa-building text-white"></i>
                            </div>
                            <div class="branch-name">본사</div>
                            <div class="branch-subtitle">Headquarters</div>
                        </a>
                    `
                    
                    // 지사 관리 아이콘 추가
                    grid.innerHTML += `
                        <a href="/static/branches.html" class="branch-card" data-branch="admin">
                            <div class="branch-icon">
                                <i class="fas fa-cog text-white"></i>
                            </div>
                            <div class="branch-name">지사 관리</div>
                            <div class="branch-subtitle">Management</div>
                        </a>
                    `
                }

                // 지사 아이콘 생성
                branches.forEach(branch => {
                    const icon = iconMap[branch.code] || iconMap['default']
                    const isMyBranch = user.role === 'branch' && user.branchId === branch.id
                    const isVisible = user.role === 'head' || isMyBranch

                    if (isVisible) {
                        grid.innerHTML += `
                            <a href="/?branch=${branch.code}" class="branch-card" data-branch="${branch.code}">
                                <div class="branch-icon">
                                    <i class="fas ${icon} text-white"></i>
                                </div>
                                <div class="branch-name">${branch.name}</div>
                                <div class="branch-subtitle">${branch.code}</div>
                            </a>
                        `
                    }
                })

                // OCR 모드 (모두 표시)
                grid.innerHTML += `
                    <a href="/ocr" class="branch-card" data-branch="ocr">
                        <div class="branch-icon">
                            <i class="fas fa-file-upload text-white"></i>
                        </div>
                        <div class="branch-name">OCR 모드</div>
                        <div class="branch-subtitle">Upload</div>
                    </a>
                `

            } catch (error) {
                console.error('Load branches error:', error)
                alert('지사 목록을 불러오는 중 오류가 발생했습니다.')
            }
        }
    </script>
</body>
</html>
